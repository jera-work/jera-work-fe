<!-- buat hr -->
<div class="min-h-screen w-10 m-auto mt-5">
  <app-button label="Back" routerLink="/job-vacancies" icon="pi pi-angle-left" border=""
    classBtn="p-button-outlined p-button-secondary mb-3">
  </app-button>
  <div class="px-6 shadow-3 py-2 relative">
    <div *ngIf="jobVacancy">
      <div class="flex flex-column md:flex-row justify-content-between my-2 h-2rem">
        <h3>Job Vacancy Detail</h3>
        <div class="flex gap-2">
          <p-button routerLink="" icon="pi pi-plus" label="Add" styleClass="m-auto p-button-success"></p-button>
          <p-button routerLink="" icon="pi pi-pencil" label="Edit" styleClass="m-auto p-button-warning"></p-button>
          <p-button icon="pi pi-eye" label="Preview" styleClass="m-auto"
            (onClick)="showPreviewModal(previewModal)"></p-button>
        </div>
      </div>
      <p-divider></p-divider>
      <div class="grid">
        <div class="grid col-6">
          <div class="col-12">
            <p>Job Title</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.vacancyTitle" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Degree</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.degreeName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Job Type</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.jobTypeName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Job Level</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.levelName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>City</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.cityName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Salary</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.salary" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Start Date</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.startDate" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>End Date</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.endDate" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Gender</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.genderName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>Status</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.statusName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>PIC HR</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.hrName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="grid col-6">
          <div class="col-12">
            <p>PIC User</p>
          </div>
          <div class="col-12">
            <input [value]="jobVacancy.hrName" pInputText id="email" class="w-full" disabled />
          </div>
        </div>
        <div class="col-12">Description</div>
        <div class="col-12">
          <div [innerHTML]="jobVacancy.description"></div>
        </div>
      </div>
    </div>

    <h3 class="mt-5">All applied candidate</h3>
    <p-divider></p-divider>

    <p-table #dt1 [value]="appliedVacancies" dataKey="id" [rows]="10" [showCurrentPageReport]="true" [paginator]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      [globalFilterFields]="['profileName', 'statusName', 'progressName']" selectionMode="single"
      styleClass="p-datatable-gridlines p-datatable-striped">
      <ng-template pTemplate="caption">
        <div class="flex flex-column md:flex-row md:align-items-center">
          <div class="p-input-icon-left m-0 md:ml-auto flex mt-3 md:mt-0">
            <i class="pi pi-search"></i>
            <input class="w-full" pInputText type="text"
              (input)="dt1.filterGlobal($any($event.target).value, 'contains')" placeholder="Search" />
          </div>
        </div>
      </ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th scope="col" class="md:col-1">No.</th>
        <th pSortableColumn="profileName" scope="col" class="md:col-4">
          <div class="flex align-items-center">
            Candidate Name
            <p-sortIcon field="profileName"> </p-sortIcon>
          </div>
        </th>
        <th pSortableColumn="createdAt" scope="col" class="md:col-4">
          <div class="flex align-items-center">
            Applied Time
            <p-sortIcon field="createdAt"> </p-sortIcon>
          </div>
        </th>
        <th pSortableColumn="progressName" scope="col" class="md:col-4">
          <div class="flex align-items-center">
            Progress
            <p-sortIcon field="progressName"></p-sortIcon>
          </div>
        </th>
        <th pSortableColumn="statusName" scope="col" class="md:col-1">
          <div class="flex align-items-center">
            Status
            <p-sortIcon field="statusName"></p-sortIcon>
          </div>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-appliedVacancy let-i="rowIndex">
      <tr routerLink="applied/{{ appliedVacancy.id }}" style="cursor: pointer">
        <td>{{ i + 1 }}</td>
        <td>{{ appliedVacancy.profileName }}</td>
        <td>{{ appliedVacancy.createdAt | timeAgo }}</td>
        <td>
          <p-tag
            [value]="appliedVacancy.progressName"
            [style]="{
              background: getProgressColor(appliedVacancy.progressCode)
            }"></p-tag>
          </td>
          <td>
            <p-tag [value]="appliedVacancy.statusName" [style]="{
              background: getStatusColor(appliedVacancy.statusCode)
            }"></p-tag>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<p-dialog #previewModal header="Header" [(visible)]="previewModalVisibility" styleClass="w-27rem" [modal]="true"
  [draggable]="false" [resizable]="false">
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">Preview</span>
  </ng-template>
  <job-preview #jobPreview
    [ageVacancyName]="jobVacancy.ageVacancyName" 
    [cityName]="jobVacancy.cityName"
    [companyDesc]="jobVacancy.companyDesc"
    [companyName]="jobVacancy.companyName"
    [companyPhotoId]="jobVacancy.companyPhotoId"
    [degreeName]="jobVacancy.degreeName"
    [description]="jobVacancy.description"
    [genderName]="jobVacancy.genderName"
    [jobTypeName]="jobVacancy.jobTypeName"
    [salary]="jobVacancy.salary"
    [vacancyTitle]="jobVacancy.vacancyTitle"></job-preview>
</p-dialog>